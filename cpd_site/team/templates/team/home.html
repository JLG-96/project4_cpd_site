{% extends "team/base.html" %}

{% block content %}

<!-- Navbar -->
<nav class="standard-nav">
    <ul>
        <li><a href="{% url 'home' %}">Home</a></li>
        <li><a href="{% url 'fixtures' %}">Fixtures</a></li>
        <li><a href="{% url 'results' %}">Results</a></li>
        <li><a href="{% url 'league_table' %}">League Table</a></li>
        {% if request.user.is_authenticated %}
            {% if request.user.profile.role == "manager" %}
                <li><a href="{% url 'manager_dashboard' %}">Manager Dashboard</a></li>
            {% elif request.user.profile.role == "player" %}
                <li><a href="{% url 'player_dashboard' %}">Player Dashboard</a></li>
            {% endif %}
            <li>
                <form action="{% url 'logout' %}" method="post">
                    {% csrf_token %}
                    <button type="submit">Logout</button>
                </form>
            </li>
        {% else %}
            <li><a href="{% url 'login' %}">Login</a></li>
        {% endif %}
    </ul>
</nav>

<!-- Team Banner -->
<section class="team-banner">
    <img src="{{ team.logo.url }}" alt="CPD Yr Wyddgrug Logo" class="club-logo">
    <div class="team-info">
        <h1>CPD Yr Wyddgrug</h1>
        <p><strong>Manager:</strong> Joel Thomas</p>
        <p><strong>Home Ground:</strong> Gwernymynydd Village Center</p>
        <p><strong>Founded:</strong> 2023</p>
    </div>
</section>

<!-- Main Homepage Grid -->
<section class="homepage-grid">
    
    <!-- Upcoming Fixture -->
    <div class="grid-item fixture-section">
        <h2>Upcoming Fixture</h2>
        {% if upcoming_fixture %}
            <div class="fixture-card">
                <img src="{{ upcoming_fixture.opponent.logo.url }}" alt="{{ upcoming_fixture.opponent }} Logo">
                <p><strong>{{ upcoming_fixture.opponent }}</strong></p>
                <p>{{ upcoming_fixture.date|date:"d/m/Y" }} at {{ upcoming_fixture.time }}</p>
                <p>Location: {{ upcoming_fixture.location }}</p>
            </div>
        {% else %}
            <p class="no-fixture">No upcoming fixtures.</p>
        {% endif %}
    </div>

    <!-- Most Recent Result -->
    <div class="grid-item result-section">
        <h2>Most Recent Result</h2>
        {% if latest_result %}
            <div class="result-card">
                <p><strong>{{ latest_result.opponent }}</strong></p>
                <p>{{ latest_result.date|date:"d/m/Y" }} at {{ latest_result.time }}</p>
                <p>Final Score: {{ latest_result.goals_for }} - {{ latest_result.goals_against }}</p>
            </div>
        {% else %}
            <p class="no-result">No results available.</p>
        {% endif %}
    </div>

    <!-- League Table Preview -->
    <div class="grid-item league-preview">
        <h2>League Table Preview</h2>
        <table>
            <thead>
                <tr>
                    <th>Pos</th>
                    <th>Team</th>
                    <th>Pts</th>
                </tr>
            </thead>
            <tbody>
                {% for team in league_preview %}
                    <tr {% if team.name == "CPD Yr Wyddgrug" %} class="highlight" {% endif %}>
                        <td>{{ team.position }}</td>
                        <td>{{ team.name }}</td>
                        <td>{{ team.points }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Manager's Comments -->
    <div class="grid-item manager-comments">
        <h2>Managerâ€™s Comments</h2>
        <p>{{ managers_comment|default:"No recent comments from the manager." }}</p>
    </div>

</section>

{% endblock %}
